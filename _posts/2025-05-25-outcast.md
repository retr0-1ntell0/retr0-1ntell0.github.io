---
title: Outcast
date: 2025-05-26 22:10:11 -5000
categories: [CTF, Nahamcon 2025, Web]
tags: [web]
toc: true
comments: false
---

### Description
Author: YesWeHack

YesWeHack has provided this CTF challenge, and they state: "This challenge is meant to be run as a black-box environment. The source code is intentionally not provided."

Light enumeration is permitted for this challenge.

NOTE, the flag for this challenge is not in the standard flag format. The format of the flag is with a flag{} wrapper but with _l33tsp3@k!_ inside the curly braces.



Special thanks to YesWeHack for the sponsorship and support of the NahamCon CTF!

### exploitation
Here is the web page:
![home](Assets/Pictures/CTF/Nahamcon-2025/home-pa.png)

Looking into the source code, we disclosed another endpoint `/test`
![notes](Assets/Pictures/CTF/Nahamcon-2025/Notes.png)

Here is what we find inside the `test` endpoint that was commented out but developer forgot to remove it:
![discovery](Assets/Pictures/CTF/Nahamcon-2025/test-endpoint.png)

We got access to two methods so far: `getusers` and `getversion`. Remembering that we are in the `api` endpoint that ios not supposed to be accessible.
The version is => `v1.3.37` but that lead us no where.

We also found this `php` code:
```php
<?php

class APICaller {
	private $url =  'http://localhost/api/';
	private $path_tmp = '/tmp/';
	private $id;

	public function __construct($id, $path_tmp = '/tmp/') {
		$this->id = $id;
		$this->path_tmp = $path_tmp;

	}

	public function __call($apiMethod, $data = array()) {
		$url = $this->url . $apiMethod;
		$data['id'] = $this->id;

		foreach ($data as $k => &$v) {
			if ( ($v) && (is_string($v)) && str_starts_with($v, '@') ) {
				$file = substr($v, 1);

				if ( str_starts_with($file, $this->path_tmp) ) {
					$v = file_get_contents($file);
				}
			}
			if (is_array($v) || is_object($v)) {
				$v = json_encode($v);
			}
		}

		// Call the API server using the given configuraions
		$ch = curl_init($url);
		curl_setopt_array($ch, array(
			CURLOPT_POST           => true,
			CURLOPT_POSTFIELDS     => $data,
			CURLOPT_RETURNTRANSFER => true,
			CURLOPT_HTTPHEADER     => array('Accept: application/json'),
		));
		$response = curl_exec($ch);
		$error  = curl_error($ch);
		
		curl_close($ch);

		if (!empty($error)) {
			throw new Exception($error);
		}

		return $response;
	}
}
```
We played around the different methods:
#### 


We accessed the login source code => view-source:http://challenge.nahamcon.com:30619/login/
And found the following:
```html
            <form class="space-y-6" action="#" method="POST">
                <div>
                    <label for="username" class="block text-sm/6 font-medium text-gray-900">Username</label>
                    <div class="mt-2">
                        <input
                            type="text"
                            name="username"
                            id="username"
                            value=""
                            required
                            class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-700 sm:text-sm/6">
                    </div>
                </div>

                <div>
                    <div class="flex items-center justify-between">
                        <label for="password" class="block text-sm/6 font-medium text-gray-900">Password</label>
                    </div>
                    <div class="mt-2">
                        <input
                            type="password"
                            name="password"
                            value=""
                            id="password"
                            required class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-red-700 sm:text-sm/6">
                    </div>
                </div>

                <div>
                    <button
                        type="submit"
                        class="flex w-full justify-center rounded-md bg-red-500 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-xs hover:bg-red-700 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-700">
                        Sign in</button>
                </div>
            </form>
```
The action is marked as `#` in the form,

We injected the following:
![flag](Assets/Pictures/CTF/Nahamcon-2025/flag-4.png)

Here is the result in clear text:

> Flag
>
> flag{ch41n1ng_bug$_1s_w0nd3rful!}
{: .prompt-info }

Happy hacking ! ðŸ˜Š